jQuery(document).ready(function(e){function t(){e("#unvalidated_rating").prop("name","rating"),e("#unvalidated_rating").prop("id","rating"),e("#title").val(""),e("textarea#comment").val(""),e("form#commentform").removeClass("edit-review"),e("form#commentform input#review_id").remove(),e("p.comment-form-rating").show(),e("p.upload_section").show(),e(".review_label").text(ywar.add_review_title),e("#cancel-comment-reply-link").is(":visible")&&e("#cancel-comment-reply-link").click()}function a(t){e(t).block({message:null,overlayCSS:{background:"#fff url("+ywar.loader+") no-repeat center",opacity:.6}})}function o(t){var a=e(t).attr("data-id_product"),o=e(t).attr("data-order"),r=e(t).attr("data-stars"),i=e(t).attr("data-page"),n=e(t).attr("data-dialog"),l={action:"get_ajax_comments",product_id:a,stars:r,order:o,data_page:i,is_modal:n,_wpnonce:ywar.nonce_value,return_path:window.location.href};return l}e("body").off("click","#respond #submit");var r='<div id="modal_reviews" class="pp_pic_holder"><a class="pp_close" href="#"></a><div class="pp_content_container"><div class="pp_left"><div class="pp_right"><div class="pp_content"><div class="pp_loaderIcon"></div><div class="pp_fade"><a href="#" class="pp_expand" title="Expand the image">Expand</a><div id="pp_full_res"></div><div class="pp_details"><div class="pp_nav"><a href="#" class="pp_arrow_previous">Previous</a><p class="currentTextHolder">0/0</p><a href="#" class="pp_arrow_next">Next</a></div><p class="pp_description"></p></div></div></div></div></div></div></div><div class="pp_overlay"></div>';e(document).on("click","#cancel-comment-reply-link",function(e){t()}),e(document).on("click","a.ywar_votereview",function(t){if(t.preventDefault(),!e(this).hasClass("ywar_votereview_selected")){var a=e(this).attr("data-id_review"),o=e(this).attr("data-vote_review"),r={action:"vote_review",id_review:a,review_value:o,_wpnonce:ywar.nonce_value,return_path:window.location.href},i="#vote_yes_"+a,n="#vote_no_"+a,l=e(this).parent();l.block({message:null,overlayCSS:{background:"#fff url("+ywar.loader+") no-repeat center",opacity:.6}}),e.post(woocommerce_params.ajax_url,r,function(t){-1==t.code?top.location.replace(t.value):1==t.code&&(1==o?(e(i).addClass("vote_selected"),e(n).removeClass("vote_selected")):(e(n).addClass("vote_selected"),e(i).removeClass("vote_selected")),l.children(".ywar_review_helpful").empty().append(t.value)),l.unblock()})}}),e(document).on("click","a.review-inappropriate",function(t){t.preventDefault();var a=e(this).attr("data-id_review"),o={action:"report_inappropriate_review",id_review:a,_wpnonce:ywar.nonce_value,return_path:window.location.href},r=e(this).parent();r.block({message:null,overlayCSS:{background:"#fff url("+ywar.loader+") no-repeat center",opacity:.6}}),e.post(woocommerce_params.ajax_url,o,function(e){r.empty().append('<span class="inappropriate-content reported">'+e.value+"</span"),r.unblock()})}),e("#reviews #comments>h2").remove(),e('a[href="#reviews"]').attr("href","#reviews_summary"),e("#tab-reviews").on("click","a.ywar_filter_reviews",function(i){i.preventDefault(),t();var n=e(this).attr("data-dialog");1!=n&&a("#reviews_summary"),e.post(woocommerce_params.ajax_url,o(e(this)),function(t){1!=n?(e("#reviews_header").empty().append(t.review_title),e("#comments ol.commentlist").empty().append(t.comment_list),e("div.ywar_show_more").empty().append(t.load_more),e("#reviews_summary").unblock()):(e("#reviews_dialog").empty().append('<ol class="commentlist">'+t.comment_list+"</ol>"),e("#reviews_dialog").append('<div class="ywar_show_more">'+t.load_more+"</div>"),e().prettyPhoto({markup:r,default_width:"70%",default_height:"200px",social_tools:!1,theme:"pp_woocommerce",modal:!0,callback:function(){e("#reviews_dialog").empty()}}),e.prettyPhoto.open("#reviews_dialog","",""),e("div.pp_pic_holder.pp_woocommerce").appendTo("#comments"))},"json")}),e(document).on("click","a.ywar_show_more, button.ywar_show_more_container",function(r){r.preventDefault(),t();var i=e(this);i.is("button")&&(i=i.children("a.ywar_show_more"));var n=i.attr("data-dialog");1!=n&&a(i),e.post(woocommerce_params.ajax_url,o(i),function(t){1!=n?(e("#reviews_header").empty().append(t.review_title),e("#reviews ol.commentlist").append(t.comment_list),e(i).unblock()):e("#modal_reviews ol.commentlist").append(t.comment_list),e("div.ywar_show_more").empty().append(t.load_more)},"json")}),e("#tab-reviews").on("click","a.ywar_filter_order",function(r){r.preventDefault(),t(),a("#reviews_order");var i=e(this);e.post(woocommerce_params.ajax_url,o(e(this)),function(t){e("#reviews_header").empty().append(t.review_title),e("ol.commentlist").empty().append(t.comment_list),e("div.ywar_show_more").empty().append(t.load_more),"most_recent_reviews"==i.attr("id")?(e("#most_recent_reviews").addClass("active"),e("#most_helpful_reviews").removeClass("active")):"most_helpful_reviews"==i.attr("id")&&(e("#most_helpful_reviews").addClass("active"),e("#most_recent_reviews").removeClass("active")),e("#reviews_order").unblock()},"json")}),e("#tab-reviews").on("click","a.edit-my-reviews",function(a){a.preventDefault();var o={action:"get_customer_reviews",product_id:e(this).data("product-id")};e("#ywar_reviews").block({message:null,overlayCSS:{background:"#fff url("+ywar.loader+") no-repeat center",opacity:.6}});e(this);e.post(woocommerce_params.ajax_url,o,function(t){e("#reviews_header").empty().append(t.review_title),e("ol.commentlist").empty().append(t.comment_list),e("#ywar_reviews").unblock()},"json"),t()}),e("#tab-reviews").on("click","a.comment-reply-link",function(t){e('select#rating option[value="5"]').prop("selected",!0),e("#title").val(""),e("textarea#comment").val(""),e("p.comment-form-rating").hide(),e("p.upload_section").hide(),e(".review_label").text(ywar.reply_to_review_title)}),e(document).on("click","a.comment-edit-link",function(t){var a=e(this).data("review-id");e("form#commentform").addClass("edit-review"),e("form#commentform").append('<input type="hidden" id="review-id" name="review-id" value="'+a+'" />'),e("p.upload_section").hide(),0!=e(this).data("parent")&&e("p.comment-form-rating").hide();var o=e(this).closest("div#comment-"+a),r=o.find("span.review_title").text();e("form#commentform #title").val(r);var i=o.find("span.review_content").text();e("form#commentform #comment").val(i);var n=e(this).data("rating");e('select#rating option[value="'+n+'"]').prop("selected",!0),e('.comment-form-rating a[class^="star-"]').removeClass("active"),e(".comment-form-rating a.star-"+n).addClass("active"),e(".review_label").text(ywar.edit_review_title)}),e(document).on("submit","form.edit-review",function(a){a.preventDefault();var o=e(this).parent();o.block({message:null,overlayCSS:{background:"#fff url("+ywar.loader+") no-repeat center",opacity:.6}});var r=e(this).find("#review-id").val(),i={action:"edit_review",review_id:r,review_title:e(this).find("#title").val(),review_content:e(this).find("#comment").val(),review_rating:e(this).find("select#rating").val()};e.post(woocommerce_params.ajax_url,i,function(t){1==t.code&&e("#li-comment-"+r).replaceWith(t.content),o.unblock()}),t()}),e(document).on("click","a.goto-reviews",function(a){a.preventDefault(),t(),e.post(woocommerce_params.ajax_url,o(e(this)),function(t){1!=open_in_dialog?(e("#reviews_header").empty().append(t.review_title),e("#comments ol.commentlist").empty().append(t.comment_list),e("div.ywar_show_more").empty().append(t.load_more),e("#reviews_summary").unblock()):(e("#reviews_dialog").empty().append('<ol class="commentlist">'+t.comment_list+"</ol>"),e("#reviews_dialog").append('<div class="ywar_show_more">'+t.load_more+"</div>"),e().prettyPhoto({markup:r,default_width:"70%",default_height:"200px",social_tools:!1,theme:"pp_woocommerce",modal:!0,callback:function(){e("#reviews_dialog").empty()}}),e.prettyPhoto.open("#reviews_dialog","",""),e("div.pp_pic_holder.pp_woocommerce").appendTo("#comments"))},"json")}),e(document).on("click","#respond form#commentform #submit",function(t){e("span.empty-review").remove();var a=ywar.is_rating_required&&!e("select#rating").val(),o=!e("#comment").val();a&&e(this).before('<span class="error empty-review">'+ywar.missing_rating_review+"</span>"),o&&e(this).before('<span class="error empty-review">'+ywar.empty_review_content+"</span>"),(a||o)&&t.preventDefault()})});